{% load static %}

<div class="mt-5">
    
    <!-- HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-3 border-bottom pb-2">
        <h6 class="fw-bold text-uppercase border-start border-5 border-warning ps-2 mb-0">
            Latest Updates
        </h6>
    </div>

    <!-- 1. NEWS CAROUSEL (Now with Clickable Arrows) -->
    <div id="newsCarouselSidebar" class="carousel slide shadow-sm rounded overflow-hidden mb-4 bg-white" data-bs-ride="carousel">
        
        <div class="carousel-inner">
            {% for article in latest_news %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
                <div class="position-relative">
                    <!-- Image Link -->
                    <a href="{% url 'news_detail' article.pk %}" class="d-block">
                        {% if article.image %}
                            <img src="{{ article.image.url }}" class="d-block w-100" style="height: 200px; object-fit: cover;" alt="{{ article.title }}">
                        {% else %}
                            <div class="bg-secondary" style="height: 200px;"></div>
                        {% endif %}
                    </a>
                    
                    <!-- News Badge -->
                    <span class="position-absolute top-0 end-0 bg-warning text-dark fw-bold small px-2 py-1 shadow-sm">NEWS</span>

                    <!-- Content Overlay -->
                    <div class="bg-primary p-3 text-white">
                        <h6 class="fw-bold mb-1" style="line-height: 1.4;">
                            <a href="{% url 'news_detail' article.pk %}" class="text-white text-decoration-none">{{ article.title|truncatechars:45 }}</a>
                        </h6>
                        <a href="{% url 'news_detail' article.pk %}" class="small text-warning text-decoration-none fst-italic">Read more &rarr;</a>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="carousel-item active">
                <div class="p-4 bg-light text-center text-muted">No news available.</div>
            </div>
            {% endfor %}
        </div>

        <!-- CLICKABLE CONTROLS (Arrows) -->
        {% if latest_news.count > 1 %}
        <button class="carousel-control-prev" type="button" data-bs-target="#newsCarouselSidebar" data-bs-slide="prev" 
                style="width: 30px; height: 30px; background: white; top: 85px; left: 0; opacity: 0.9; border-radius: 0 5px 5px 0;">
            <span class="carousel-control-prev-icon" aria-hidden="true" style="filter: invert(1); transform: scale(0.6);"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#newsCarouselSidebar" data-bs-slide="next" 
                style="width: 30px; height: 30px; background: white; top: 85px; right: 0; opacity: 0.9; border-radius: 5px 0 0 5px;">
            <span class="carousel-control-next-icon" aria-hidden="true" style="filter: invert(1); transform: scale(0.6);"></span>
            <span class="visually-hidden">Next</span>
        </button>
        {% endif %}
    </div>

    <!-- 2. UPCOMING EVENTS LIST -->
    {% if upcoming_events %}
    <div class="card border-0 shadow-sm">
        <div class="card-header bg-white border-bottom fw-bold text-uppercase small text-muted">
            <i class="far fa-calendar-alt me-1"></i> Upcoming Events
        </div>
        <div class="list-group list-group-flush">
            {% for event in upcoming_events %}
            <a href="{% url 'event_detail' event.pk %}" class="list-group-item list-group-item-action py-2 d-flex align-items-center">
                
                <!-- Small Date Box -->
                <div class="text-center me-3 border rounded bg-light" style="width: 45px; height: 45px; display: flex; flex-direction: column; justify-content: center;">
                    <span class="d-block fw-bold text-primary" style="font-size: 1rem; line-height: 1;">{{ event.date|date:"d" }}</span>
                    <span class="d-block text-uppercase fw-bold text-muted" style="font-size: 0.6rem;">{{ event.date|date:"M" }}</span>
                </div>
                
                <!-- Info -->
                <div style="flex: 1;">
                    <h6 class="fw-bold text-dark mb-0 small text-truncate" style="max-width: 180px;">{{ event.title }}</h6>
                    <small class="text-muted" style="font-size: 0.75rem;">
                        <i class="far fa-clock text-warning"></i> {{ event.time|time:"h:i A" }}
                    </small>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
    {% else %}
        <!-- Message if no events found -->
        <div class="alert alert-light border text-center small text-muted">
            No upcoming events scheduled.
        </div>
    {% endif %}

</div>