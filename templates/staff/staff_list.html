{% extends 'base.html' %}
{% load static %}

{% block content %}

<!-- Dynamic Header (purple background) -->
<div class="bg-primary py-5 text-white text-center" style="background: linear-gradient(rgba(74, 20, 140, 0.95), rgba(74, 20, 140, 0.95)), url('{% static 'img/banner.jpg' %}') center/cover;">
    <div class="container">
        <h1 class="fw-bold display-5">{{ page_title }}</h1>
        <p class="mb-0 text-white-50 text-uppercase">HOME / {{ page_title }}</p>
    </div>
</div>

<div class="container py-5">
    
    <!-- CSS for Circle Cards -->
    <style>
        .staff-circle-img {
            width: 180px;
            height: 180px;
            object-fit: cover;
            border-radius: 50%;
            border: 5px solid #f8f9fa;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        .staff-card:hover .staff-circle-img {
            transform: scale(1.05);
            border-color: var(--ants-gold);
        }
        .read-more-link {
            color: var(--ants-purple);
            text-decoration: none;
            font-size: 0.9rem;
        }
        .read-more-link:hover {
            color: var(--ants-gold);
            text-decoration: underline;
        }
        /* Fix alignment for grid titles */
        .staff-card h5 { min-height: 40px; display: flex; align-items: end; justify-content: center; }
        .staff-card p { min-height: 30px; }
    </style>

    <!-- ========================================= -->
    <!-- 1. MANAGEMENT SECTION (Principal + Admin) -->
    <!-- ========================================= -->
    {% if management or principal %}
    
        <!-- Only show this sub-heading if we are on the main full directory page -->
        {% if page_title == 'Staff Directory' %}
            <h3 class="text-center fw-bold mb-5 position-relative">
                <span class="border-bottom border-3 border-warning pb-2">Management & Administration</span>
            </h3>
        {% endif %}

        <div class="row text-center justify-content-center">
            
            <!-- A. THE PRINCIPAL (Placed first in the grid) -->
            {% if principal %}
            <div class="col-lg-3 col-md-4 col-sm-6 mb-5">
                <div class="staff-card">
                    <a href="{% url 'staff_detail' principal.slug %}">
                        {% if principal.photo %}
                            <img src="{{ principal.photo.url }}" class="staff-circle-img mb-3" alt="{{ principal.name }}">
                        {% else %}
                            <img src="https://via.placeholder.com/200" class="staff-circle-img mb-3" alt="Placeholder">
                        {% endif %}
                    </a>
                    <!-- Highlight Principal Name Slightly -->
                    <h5 class="fw-bold text-primary mb-1" style="color: var(--ants-purple) !important; font-size: 1.25rem;">
                        <a href="{% url 'staff_detail' principal.slug %}">{{ principal.name }}</a>
                    </h5>
                    <p class="fw-bold text-warning small mb-2 text-uppercase">{{ principal.role }}</p>
                    <a href="{% url 'staff_detail' principal.slug %}" class="read-more-link">Read more</a>
                </div>
            </div>
            {% endif %}

            <!-- B. REST OF MANAGEMENT -->
            {% for staff in management %}
            <div class="col-lg-3 col-md-4 col-sm-6 mb-5">
                <div class="staff-card">
                    <a href="{% url 'staff_detail' staff.slug %}">
                        {% if staff.photo %}
                            <img src="{{ staff.photo.url }}" class="staff-circle-img mb-3" alt="{{ staff.name }}">
                        {% else %}
                            <img src="https://via.placeholder.com/200" class="staff-circle-img mb-3" alt="Placeholder">
                        {% endif %}
                    </a>
                    <h5 class="fw-bold text-dark mb-1">
                        <a href="{% url 'staff_detail' staff.slug %}" class="text-dark text-decoration-none">{{ staff.name }}</a>
                    </h5>
                    <p class="text-muted small mb-2 fw-bold">{{ staff.role }}</p>
                    <a href="{% url 'staff_detail' staff.slug %}" class="read-more-link">Read more</a>
                </div>
            </div>
            {% endfor %}
        </div>
    {% endif %}


    <!-- ========================================= -->
    <!-- 2. OFFICE STAFF SECTION                   -->
    <!-- ========================================= -->
    {% if office %}
        {% if page_title == 'Staff Directory' %}<hr class="my-4">{% endif %}
        
        <h3 class="text-center fw-bold mb-5 mt-4">
            <span class="border-bottom border-3 border-warning pb-2">Office Staff</span>
        </h3>
        <div class="row text-center justify-content-center">
            {% for staff in office %}
            <div class="col-lg-3 col-md-4 col-sm-6 mb-5">
                <div class="staff-card">
                    <a href="{% url 'staff_detail' staff.slug %}">
                        {% if staff.photo %}
                            <img src="{{ staff.photo.url }}" class="staff-circle-img mb-3" alt="{{ staff.name }}">
                        {% else %}
                            <img src="https://via.placeholder.com/200" class="staff-circle-img mb-3" alt="Placeholder">
                        {% endif %}
                    </a>
                    <h5 class="fw-bold text-dark mb-1">
                        <a href="{% url 'staff_detail' staff.slug %}" class="text-dark text-decoration-none">{{ staff.name }}</a>
                    </h5>
                    <p class="text-muted small mb-2 fw-bold">{{ staff.role }}</p>
                    <a href="{% url 'staff_detail' staff.slug %}" class="read-more-link">Read more</a>
                </div>
            </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- ========================================= -->
    <!-- 3. ACADEMIC STAFF SECTION                 -->
    <!-- ========================================= -->
    {% if academic %}
        {% if page_title == 'Staff Directory' %}<hr class="my-4">{% endif %}

        <h3 class="text-center fw-bold mb-5 mt-4">
            <span class="border-bottom border-3 border-warning pb-2">Faculty & Lecturers</span>
        </h3>
        <div class="row text-center justify-content-center">
            {% for staff in academic %}
            <div class="col-lg-3 col-md-4 col-sm-6 mb-5">
                <div class="staff-card">
                    <a href="{% url 'staff_detail' staff.slug %}">
                        {% if staff.photo %}
                            <img src="{{ staff.photo.url }}" class="staff-circle-img mb-3" alt="{{ staff.name }}">
                        {% else %}
                            <img src="https://via.placeholder.com/200" class="staff-circle-img mb-3" alt="Placeholder">
                        {% endif %}
                    </a>
                    <h5 class="fw-bold text-dark mb-1">
                        <a href="{% url 'staff_detail' staff.slug %}" class="text-dark text-decoration-none">{{ staff.name }}</a>
                    </h5>
                    <p class="text-muted small mb-2 fw-bold">{{ staff.role }}</p>
                    <a href="{% url 'staff_detail' staff.slug %}" class="read-more-link">Read more</a>
                </div>
            </div>
            {% endfor %}
        </div>
    {% endif %}

</div>
{% endblock %}